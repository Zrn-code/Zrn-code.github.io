<!-- build time:Fri Aug 26 2022 11:48:39 GMT+0800 (台北標準時間) --><!DOCTYPE html><html lang="zh-TW"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="為了夢想、永不停歇" href="https://zrn-code.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="為了夢想、永不停歇" href="https://zrn-code.github.io/atom.xml"><link rel="alternate" type="application/json" title="為了夢想、永不停歇" href="https://zrn-code.github.io/feed.json"><script src="//code.tidio.co/xwpoo3nkpkhs9n7qnbgoxgfroyidjvjl.js" async></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/artitalk"></script><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="python,資料分析,pandas"><link rel="canonical" href="https://zrn-code.github.io/2022/07/23/python-data-analysis-2/"><title>Pandas 資料分析 (下) - AI 相關 | Zrn Code = 為了夢想、永不停歇</title><meta name="generator" content="Hexo 5.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Pandas 資料分析 (下)</h1><div class="meta"><span class="item" title="創建時間：2022-07-23 19:20:25"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">發表於</span> <time itemprop="dateCreated datePublished" datetime="2022-07-23T19:20:25+08:00">2022-07-23</time> </span><span class="item" title="文章字數"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">文章字數</span> <span>11k</span> <span class="text">字</span> </span><span class="item" title="所需閱讀時間"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">所需閱讀時間</span> <span>10 分鐘</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切換導航欄"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Zrn Code</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva3.sinaimg.cn/large/006q0MNVgy1gyquyzcc53j315o0n2wkc.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giciub8ja1j20zk0m81ky.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipexbei4hj20zk0m8npd.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/006q0MNVgy1h3u38hsk6oj315o0n9afm.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/006q0MNVgy1gywn2vmdypj315o0r3al9.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/006q0MNVgy1gyquz3foy0j315o0ng12s.jpg"></li></ul></div><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div></header><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首頁</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/AI%E7%9B%B8%E9%97%9C/" itemprop="item" rel="index" title="分類於 AI 相關"><span itemprop="name">AI 相關</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-TW"><link itemprop="mainEntityOfPage" href="https://zrn-code.github.io/2022/07/23/python-data-analysis-2/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Zrn Ye"><meta itemprop="description" content=", 堅強，只為那些期待眼神"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="為了夢想、永不停歇"></span><div class="body md" itemprop="articleBody"><ul><li>Ch.4 <code>Grouping</code> and <code>Sorting</code></li><li>Ch.5 <code>Data Types</code> and <code>Missing Values</code></li><li>Ch.6 <code>Renaming</code> and <code>Combining</code></li></ul><hr><a id="more"></a><h2 id="chapter-4"><a class="anchor" href="#chapter-4">#</a> Chapter 4</h2><h3 id="groupwise-analysis"><a class="anchor" href="#groupwise-analysis">#</a> Groupwise analysis</h3><p>使用 <code>groupby()</code> 方法可以將資料依照自己要的 column 分組，它會將類別相同的數值進行合併並一同分析。<br>這邊我們使用 <code>count()</code> 統計各個 <code>points</code> 出現的數量:</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'points'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><pre><code>points
80     397
81     692
      ... 
99      33
100     19
Name: points, Length: 21, dtype: int64
</code></pre></div></details><p>除此之外，我們也可以使用 <code>describe()</code> 中用過的所有函式對數值進行分析。<br>例如：我想知道各項的 <code>points</code> 中，最便宜的價格為多少。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'points'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>price<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#運算結果見註解</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><pre><code>points
80      5.0 #所有80分的酒中，最低價的是5.0元
81      5.0
       ... 
99     44.0
100    80.0 #所有100分的酒中，最低價的是80.0元
Name: price, Length: 21, dtype: float64
</code></pre></div></details><p>使用 <code>groupby()</code> 建立的表格數值本身就已經有對應上，因此，我們可以<strong>直接使用</strong> <code>apply()</code> 對資料做映射處理:</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'winery'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> df<span class="token punctuation">:</span> df<span class="token punctuation">.</span>title<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><pre><code>winery
1+1=3                          1+1=3 NV Rosé Sparkling (Cava)
10 Knots                 10 Knots 2010 Viognier (Paso Robles)
                                  ...                        
àMaurice    àMaurice 2013 Fred Estate Syrah (Walla Walla V...
Štoka                         Štoka 2009 Izbrani Teran (Kras)
Length: 16757, dtype: object
</code></pre></div></details><p><code>groupby()</code> 也可以同時對多 column 做分組分析 (也就是 <code>Multi-indexes</code> )<br>例如：列出每一個國家與其省份分數最高的酒類資料。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">,</span> <span class="token string">'province'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> df<span class="token punctuation">:</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">.</span>points<span class="token punctuation">.</span>idxmax<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><blockquote><p><code>idmax()</code> 會回傳第一個最大值的索引值</p></blockquote><details class="info"><summary>運算結果</summary><div><table><thead><tr><th style="text-align:left"></th><th style="text-align:left">country</th><th style="text-align:left">description</th><th style="text-align:left">designation</th><th style="text-align:right">points</th><th style="text-align:right">price</th><th style="text-align:left">province</th><th style="text-align:left">region_1</th><th style="text-align:right">region_2</th><th style="text-align:left">taster_name</th><th style="text-align:left">taster_twitter_handle</th><th style="text-align:left">title</th><th style="text-align:left">variety</th><th style="text-align:left">winery</th></tr></thead><tbody><tr><td style="text-align:left">('Argentina', 'Mendoza Province')</td><td style="text-align:left">Argentina</td><td style="text-align:left">If the color doesn't tell the full story, the nose will: it's impeccably perfumed, round and sweet, with amazing fruit aromas and a toasty background. The feel is as lush and rich as they come, and there's outstanding purity to the lusty black fruit flavors. A masher with elegance. Maybe the best Malbec Argentina has ever produced. Drink from 2011–15.</td><td style="text-align:left">Nicasia Vineyard</td><td style="text-align:right">97</td><td style="text-align:right">120</td><td style="text-align:left">Mendoza Province</td><td style="text-align:left">Mendoza</td><td style="text-align:right">nan</td><td style="text-align:left">Michael Schachner</td><td style="text-align:left">@wineschach</td><td style="text-align:left">Bodega Catena Zapata 2006 Nicasia Vineyard Malbec (Mendoza)</td><td style="text-align:left">Malbec</td><td style="text-align:left">Bodega Catena Zapata</td></tr><tr><td style="text-align:left">('Argentina', 'Other')</td><td style="text-align:left">Argentina</td><td style="text-align:left">Take note, this could be the best wine Colomé has ever bottled. Cedary oak aromas grace ripe, almost desiccated wild berry notes that are slightly herbal and sauvage. A well-layered mouthfeel is ideal in power and precision. Requisite blackberry, cassis, toast and peppery flavors finish dry and long, with little heat or burn. Drink through 2021.</td><td style="text-align:left">Reserva</td><td style="text-align:right">95</td><td style="text-align:right">90</td><td style="text-align:left">Other</td><td style="text-align:left">Salta</td><td style="text-align:right">nan</td><td style="text-align:left">Michael Schachner</td><td style="text-align:left">@wineschach</td><td style="text-align:left">Colomé 2010 Reserva Malbec (Salta)</td><td style="text-align:left">Malbec</td><td style="text-align:left">Colomé</td></tr><tr><td style="text-align:left">('Armenia', 'Armenia')</td><td style="text-align:left">Armenia</td><td style="text-align:left">Deep salmon in color, this wine offers a bouquet of cantaloupe and nectarine. It is bright on entry, with full mouthfeel and flavors of pineapple, grapefruit and white peach that culminate in a bright citrus finish.</td><td style="text-align:left">Estate Bottled</td><td style="text-align:right">88</td><td style="text-align:right">15</td><td style="text-align:left">Armenia</td><td style="text-align:left">nan</td><td style="text-align:right">nan</td><td style="text-align:left">Mike DeSimone</td><td style="text-align:left">@worldwineguys</td><td style="text-align:left">Van Ardi 2015 Estate Bottled Rosé (Armenia)</td><td style="text-align:left">Rosé</td><td style="text-align:left">Van Ardi</td></tr><tr><td style="text-align:left">('Australia', 'Australia Other')</td><td style="text-align:left">Australia</td><td style="text-align:left">Writes the book on how to make a wine filled with gigantic jammy fruit that's nonetheless dry, balanced and harmonious. The Cabernet contributes blackcurrants and structural tannins. The Syrah brings a peppery richness, while Merlot adds soft fruitiness. You can actually taste each varietal, yet the wine hangs together, dry and rich. Best Buy.</td><td style="text-align:left">Sarah's Blend</td><td style="text-align:right">93</td><td style="text-align:right">15</td><td style="text-align:left">Australia Other</td><td style="text-align:left">South Eastern Australia</td><td style="text-align:right">nan</td><td style="text-align:left">nan</td><td style="text-align:left">nan</td><td style="text-align:left">Marquis Philips 2000 Sarah's Blend Red (South Eastern Australia)</td><td style="text-align:left">Red Blend</td><td style="text-align:left">Marquis Philips</td></tr><tr><td style="text-align:left">('Australia', 'New South Wales')</td><td style="text-align:left">Australia</td><td style="text-align:left">De Bortoli's Noble One is as good as ever in 2007, offering intense botrytis, dried apricots, honey and bergamot in a sweetly unctuous style. Think of a Sauternes, but with more sugar and less alcohol. It should age well for 10 or more years.</td><td style="text-align:left">Noble One Bortytis</td><td style="text-align:right">94</td><td style="text-align:right">32</td><td style="text-align:left">New South Wales</td><td style="text-align:left">New South Wales</td><td style="text-align:right">nan</td><td style="text-align:left">Joe Czerwinski</td><td style="text-align:left">@JoeCz</td><td style="text-align:left">De Bortoli 2007 Noble One Bortytis Semillon (New South Wales)</td><td style="text-align:left">Sémillon</td><td style="text-align:left">De Bortoli</td></tr></tbody></table></div></details><p>我們可以使用 <code>agg()</code> ，同時對一組數據做不同的函式比較:</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 同時對不同 country 的 price 分別做分析 (資料數，最小值，最大值)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>price<span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><table><thead><tr><th style="text-align:left">country</th><th style="text-align:right">len</th><th style="text-align:right">min</th><th style="text-align:right">max</th></tr></thead><tbody><tr><td style="text-align:left">Argentina</td><td style="text-align:right">3800</td><td style="text-align:right">4</td><td style="text-align:right">230</td></tr><tr><td style="text-align:left">Armenia</td><td style="text-align:right">2</td><td style="text-align:right">14</td><td style="text-align:right">15</td></tr><tr><td style="text-align:left">Australia</td><td style="text-align:right">2329</td><td style="text-align:right">5</td><td style="text-align:right">850</td></tr><tr><td style="text-align:left">Austria</td><td style="text-align:right">3345</td><td style="text-align:right">7</td><td style="text-align:right">1100</td></tr><tr><td style="text-align:left">Bosnia and Herzegovina</td><td style="text-align:right">2</td><td style="text-align:right">12</td><td style="text-align:right">13</td></tr></tbody></table></div></details><h3 id="multi-indexes"><a class="anchor" href="#multi-indexes">#</a> Multi-indexes</h3><p>之前我們就稍有提到，我們建立的群組也可以對多個 column 進行描述與運算。<br>這裡舉個簡單的例子：我想知道各國家的各省份各有多少筆資料:</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>countries_reviewed <span class="token operator">=</span> reviews<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">,</span> <span class="token string">'province'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>description<span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>countries_reviewed<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><table><thead><tr><th style="text-align:left"></th><th style="text-align:right">len</th></tr></thead><tbody><tr><td style="text-align:left">('Argentina', 'Mendoza Province')</td><td style="text-align:right">3264</td></tr><tr><td style="text-align:left">('Argentina', 'Other')</td><td style="text-align:right">536</td></tr><tr><td style="text-align:left">('Armenia', 'Armenia')</td><td style="text-align:right">2</td></tr><tr><td style="text-align:left">('Australia', 'Australia Other')</td><td style="text-align:right">245</td></tr><tr><td style="text-align:left">('Australia', 'New South Wales')</td><td style="text-align:right">85</td></tr></tbody></table></div></details><p>使用多個 column 資料所建立的表格，其索引值並非傳統的 <code>Index</code> ，而是 <code>padas</code> 內建的 <code>MultiIndex</code> 。<br><code>pandas</code> 有特定的方法可以對 <code>MutiIndex</code> 做出更複雜的操作。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>mi <span class="token operator">=</span> countries_reviewed<span class="token punctuation">.</span>index</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token builtin">type</span><span class="token punctuation">(</span>mi<span class="token punctuation">)</span> <span class="token comment"># 運算結果為: pandas.core.indexes.multi.MultiIndex</span></pre></td></tr></table></figure><p>但通常我會直接使用 <code>reset_index()</code> 這方法對現有的表格重製為比較單純的索引值。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>countries_reviewed<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><table><thead><tr><th style="text-align:right"></th><th style="text-align:left">country</th><th style="text-align:left">province</th><th style="text-align:right">len</th></tr></thead><tbody><tr><td style="text-align:right">0</td><td style="text-align:left">Argentina</td><td style="text-align:left">Mendoza Province</td><td style="text-align:right">3264</td></tr><tr><td style="text-align:right">1</td><td style="text-align:left">Argentina</td><td style="text-align:left">Other</td><td style="text-align:right">536</td></tr><tr><td style="text-align:right">2</td><td style="text-align:left">Armenia</td><td style="text-align:left">Armenia</td><td style="text-align:right">2</td></tr><tr><td style="text-align:right">3</td><td style="text-align:left">Australia</td><td style="text-align:left">Australia Other</td><td style="text-align:right">245</td></tr><tr><td style="text-align:right">4</td><td style="text-align:left">Australia</td><td style="text-align:left">New South Wales</td><td style="text-align:right">85</td></tr></tbody></table></div></details><h3 id="sorting"><a class="anchor" href="#sorting">#</a> Sorting</h3><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>countries_reviewed <span class="token operator">=</span> countries_reviewed<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>countries_reviewed<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'len'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><table><thead><tr><th style="text-align:right"></th><th style="text-align:right">index</th><th style="text-align:left">country</th><th style="text-align:left">province</th><th style="text-align:right">len</th></tr></thead><tbody><tr><td style="text-align:right">179</td><td style="text-align:right">179</td><td style="text-align:left">Greece</td><td style="text-align:left">Muscat of Kefallonian</td><td style="text-align:right">1</td></tr><tr><td style="text-align:right">192</td><td style="text-align:right">192</td><td style="text-align:left">Greece</td><td style="text-align:left">Sterea Ellada</td><td style="text-align:right">1</td></tr><tr><td style="text-align:right">194</td><td style="text-align:right">194</td><td style="text-align:left">Greece</td><td style="text-align:left">Thraki</td><td style="text-align:right">1</td></tr><tr><td style="text-align:right">354</td><td style="text-align:right">354</td><td style="text-align:left">South Africa</td><td style="text-align:left">Paardeberg</td><td style="text-align:right">1</td></tr><tr><td style="text-align:right">40</td><td style="text-align:right">40</td><td style="text-align:left">Brazil</td><td style="text-align:left">Serra do Sudeste</td><td style="text-align:right">1</td></tr><tr><td style="text-align:right">114</td><td style="text-align:right">114</td><td style="text-align:left">Egypt</td><td style="text-align:left">Egypt</td><td style="text-align:right">1</td></tr><tr><td style="text-align:right">316</td><td style="text-align:right">316</td><td style="text-align:left">Serbia</td><td style="text-align:left">Pocerina</td><td style="text-align:right">1</td></tr><tr><td style="text-align:right">112</td><td style="text-align:right">112</td><td style="text-align:left">Cyprus</td><td style="text-align:left">Pitsilia Mountains</td><td style="text-align:right">1</td></tr><tr><td style="text-align:right">110</td><td style="text-align:right">110</td><td style="text-align:left">Cyprus</td><td style="text-align:left">Lemesos</td><td style="text-align:right">1</td></tr><tr><td style="text-align:right">301</td><td style="text-align:right">301</td><td style="text-align:left">Portugal</td><td style="text-align:left">Vinho da Mesa</td><td style="text-align:right">1</td></tr></tbody></table></div></details><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>countries_reviewed<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'len'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><table><thead><tr><th style="text-align:right"></th><th style="text-align:right">level_0</th><th style="text-align:right">index</th><th style="text-align:left">country</th><th style="text-align:left">province</th><th style="text-align:right">len</th></tr></thead><tbody><tr><td style="text-align:right">392</td><td style="text-align:right">392</td><td style="text-align:right">392</td><td style="text-align:left">US</td><td style="text-align:left">California</td><td style="text-align:right">36247</td></tr><tr><td style="text-align:right">415</td><td style="text-align:right">415</td><td style="text-align:right">415</td><td style="text-align:left">US</td><td style="text-align:left">Washington</td><td style="text-align:right">8639</td></tr><tr><td style="text-align:right">118</td><td style="text-align:right">118</td><td style="text-align:right">118</td><td style="text-align:left">France</td><td style="text-align:left">Bordeaux</td><td style="text-align:right">5941</td></tr><tr><td style="text-align:right">227</td><td style="text-align:right">227</td><td style="text-align:right">227</td><td style="text-align:left">Italy</td><td style="text-align:left">Tuscany</td><td style="text-align:right">5897</td></tr><tr><td style="text-align:right">409</td><td style="text-align:right">409</td><td style="text-align:right">409</td><td style="text-align:left">US</td><td style="text-align:left">Oregon</td><td style="text-align:right">5373</td></tr><tr><td style="text-align:right">119</td><td style="text-align:right">119</td><td style="text-align:right">119</td><td style="text-align:left">France</td><td style="text-align:left">Burgundy</td><td style="text-align:right">3980</td></tr><tr><td style="text-align:right">375</td><td style="text-align:right">375</td><td style="text-align:right">375</td><td style="text-align:left">Spain</td><td style="text-align:left">Northern Spain</td><td style="text-align:right">3851</td></tr><tr><td style="text-align:right">224</td><td style="text-align:right">224</td><td style="text-align:right">224</td><td style="text-align:left">Italy</td><td style="text-align:left">Piedmont</td><td style="text-align:right">3729</td></tr><tr><td style="text-align:right">0</td><td style="text-align:right">0</td><td style="text-align:right">0</td><td style="text-align:left">Argentina</td><td style="text-align:left">Mendoza Province</td><td style="text-align:right">3264</td></tr><tr><td style="text-align:right">228</td><td style="text-align:right">228</td><td style="text-align:right">228</td><td style="text-align:left">Italy</td><td style="text-align:left">Veneto</td><td style="text-align:right">2716</td></tr></tbody></table></div></details><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>countries_reviewed<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><table><thead><tr><th style="text-align:right"></th><th style="text-align:right">level_0</th><th style="text-align:right">index</th><th style="text-align:left">country</th><th style="text-align:left">province</th><th style="text-align:right">len</th></tr></thead><tbody><tr><td style="text-align:right">0</td><td style="text-align:right">0</td><td style="text-align:right">0</td><td style="text-align:left">Argentina</td><td style="text-align:left">Mendoza Province</td><td style="text-align:right">3264</td></tr><tr><td style="text-align:right">1</td><td style="text-align:right">1</td><td style="text-align:right">1</td><td style="text-align:left">Argentina</td><td style="text-align:left">Other</td><td style="text-align:right">536</td></tr><tr><td style="text-align:right">2</td><td style="text-align:right">2</td><td style="text-align:right">2</td><td style="text-align:left">Armenia</td><td style="text-align:left">Armenia</td><td style="text-align:right">2</td></tr><tr><td style="text-align:right">3</td><td style="text-align:right">3</td><td style="text-align:right">3</td><td style="text-align:left">Australia</td><td style="text-align:left">Australia Other</td><td style="text-align:right">245</td></tr><tr><td style="text-align:right">4</td><td style="text-align:right">4</td><td style="text-align:right">4</td><td style="text-align:left">Australia</td><td style="text-align:left">New South Wales</td><td style="text-align:right">85</td></tr><tr><td style="text-align:right">5</td><td style="text-align:right">5</td><td style="text-align:right">5</td><td style="text-align:left">Australia</td><td style="text-align:left">South Australia</td><td style="text-align:right">1349</td></tr><tr><td style="text-align:right">6</td><td style="text-align:right">6</td><td style="text-align:right">6</td><td style="text-align:left">Australia</td><td style="text-align:left">Tasmania</td><td style="text-align:right">42</td></tr><tr><td style="text-align:right">7</td><td style="text-align:right">7</td><td style="text-align:right">7</td><td style="text-align:left">Australia</td><td style="text-align:left">Victoria</td><td style="text-align:right">322</td></tr><tr><td style="text-align:right">8</td><td style="text-align:right">8</td><td style="text-align:right">8</td><td style="text-align:left">Australia</td><td style="text-align:left">Western Australia</td><td style="text-align:right">286</td></tr><tr><td style="text-align:right">9</td><td style="text-align:right">9</td><td style="text-align:right">9</td><td style="text-align:left">Austria</td><td style="text-align:left">Austria</td><td style="text-align:right">26</td></tr></tbody></table></div></details><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>countries_reviewed<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">,</span> <span class="token string">'len'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><table><thead><tr><th style="text-align:right"></th><th style="text-align:right">level_0</th><th style="text-align:right">index</th><th style="text-align:left">country</th><th style="text-align:left">province</th><th style="text-align:right">len</th></tr></thead><tbody><tr><td style="text-align:right">1</td><td style="text-align:right">1</td><td style="text-align:right">1</td><td style="text-align:left">Argentina</td><td style="text-align:left">Other</td><td style="text-align:right">536</td></tr><tr><td style="text-align:right">0</td><td style="text-align:right">0</td><td style="text-align:right">0</td><td style="text-align:left">Argentina</td><td style="text-align:left">Mendoza Province</td><td style="text-align:right">3264</td></tr><tr><td style="text-align:right">2</td><td style="text-align:right">2</td><td style="text-align:right">2</td><td style="text-align:left">Armenia</td><td style="text-align:left">Armenia</td><td style="text-align:right">2</td></tr><tr><td style="text-align:right">6</td><td style="text-align:right">6</td><td style="text-align:right">6</td><td style="text-align:left">Australia</td><td style="text-align:left">Tasmania</td><td style="text-align:right">42</td></tr><tr><td style="text-align:right">4</td><td style="text-align:right">4</td><td style="text-align:right">4</td><td style="text-align:left">Australia</td><td style="text-align:left">New South Wales</td><td style="text-align:right">85</td></tr><tr><td style="text-align:right">3</td><td style="text-align:right">3</td><td style="text-align:right">3</td><td style="text-align:left">Australia</td><td style="text-align:left">Australia Other</td><td style="text-align:right">245</td></tr><tr><td style="text-align:right">8</td><td style="text-align:right">8</td><td style="text-align:right">8</td><td style="text-align:left">Australia</td><td style="text-align:left">Western Australia</td><td style="text-align:right">286</td></tr><tr><td style="text-align:right">7</td><td style="text-align:right">7</td><td style="text-align:right">7</td><td style="text-align:left">Australia</td><td style="text-align:left">Victoria</td><td style="text-align:right">322</td></tr><tr><td style="text-align:right">5</td><td style="text-align:right">5</td><td style="text-align:right">5</td><td style="text-align:left">Australia</td><td style="text-align:left">South Australia</td><td style="text-align:right">1349</td></tr><tr><td style="text-align:right">20</td><td style="text-align:right">20</td><td style="text-align:right">20</td><td style="text-align:left">Austria</td><td style="text-align:left">Südburgenland</td><td style="text-align:right">2</td></tr></tbody></table></div></details><h2 id="chapter-5"><a class="anchor" href="#chapter-5">#</a> Chapter 5</h2><h3 id="dtypes"><a class="anchor" href="#dtypes">#</a> Dtypes</h3><p><code>dtype</code> 可以取得特定 column 的資料型態</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#查看 price 的資料型態</span></pre></td></tr><tr><td data-num="2"></td><td><pre>reviews<span class="token punctuation">.</span>price<span class="token punctuation">.</span>dtype</pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><pre><code>dtype('float64')
</code></pre></div></details><p>當然的， <code>dtype</code> 也可以取得該 <code>DataFrame</code> 中所有 column 的資料型態</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>reviews<span class="token punctuation">.</span>dtypes</pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><pre><code>country                   object
description               object
designation               object
points                     int64
price                    float64
province                  object
region_1                  object
region_2                  object
taster_name               object
taster_twitter_handle     object
title                     object
variety                   object
winery                    object
dtype: object
</code></pre></div></details><div class="note info"><p>字串組成的那整欄會被視為 <code>object</code> ，而不是 <code>stringㄅ</code></p></div><p>使用 <code>astype()</code> 可以強制轉換型態。<br>例如：將 <code>points</code> 原有的型態 <code>int64</code> 轉成 <code>float64</code> 。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>reviews<span class="token punctuation">.</span>points<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'float64'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><pre><code>0         87.0
1         87.0
          ... 
129969    90.0
129970    90.0
Name: points, Length: 129971, dtype: float64
</code></pre></div></details><h3 id="missing-data"><a class="anchor" href="#missing-data">#</a> Missing data</h3><p>&quot;Not a Number&quot;</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>reviews<span class="token punctuation">[</span>pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span>reviews<span class="token punctuation">.</span>country<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><table><thead><tr><th style="text-align:right"></th><th style="text-align:right">country</th><th style="text-align:left">description</th><th style="text-align:left">designation</th><th style="text-align:right">points</th><th style="text-align:right">price</th><th style="text-align:right">province</th><th style="text-align:right">region_1</th><th style="text-align:right">region_2</th><th style="text-align:left">taster_name</th><th style="text-align:left">taster_twitter_handle</th><th style="text-align:left">title</th><th style="text-align:left">variety</th><th style="text-align:left">winery</th></tr></thead><tbody><tr><td style="text-align:right">913</td><td style="text-align:right">nan</td><td style="text-align:left">Amber in color, this wine has aromas of peach jam and orange blossom. Flavors are a mélange of mellow fruit and savory notes, in particular apricot, lemon curd, quince and bitter almond. Despite strong tannins, there are moments of brightness across the entire palate that linger into the finish.</td><td style="text-align:left">Asureti Valley</td><td style="text-align:right">87</td><td style="text-align:right">30</td><td style="text-align:right">nan</td><td style="text-align:right">nan</td><td style="text-align:right">nan</td><td style="text-align:left">Mike DeSimone</td><td style="text-align:left">@worldwineguys</td><td style="text-align:left">Gotsa Family Wines 2014 Asureti Valley Chinuri</td><td style="text-align:left">Chinuri</td><td style="text-align:left">Gotsa Family Wines</td></tr><tr><td style="text-align:right">3131</td><td style="text-align:right">nan</td><td style="text-align:left">Soft, fruity and juicy, this is a pleasant, simple wine that is a blend from different European countries. It is balanced and very drinkable for parties or barbecues. Screwcap.</td><td style="text-align:left">Partager</td><td style="text-align:right">83</td><td style="text-align:right">nan</td><td style="text-align:right">nan</td><td style="text-align:right">nan</td><td style="text-align:right">nan</td><td style="text-align:left">Roger Voss</td><td style="text-align:left">@vossroger</td><td style="text-align:left">Barton &amp; Guestier NV Partager Red</td><td style="text-align:left">Red Blend</td><td style="text-align:left">Barton &amp; Guestier</td></tr><tr><td style="text-align:right">4243</td><td style="text-align:right">nan</td><td style="text-align:left">Violet-red in color, this semisweet wine has a nose of blackberry and vanilla. It is soft on entry, with flavors of black cherry, blueberry and creme brûlée. It is smooth on the palate, while the blueberry pie finish is brightened up by a brief but not unwelcome tart note.</td><td style="text-align:left">Red Naturally Semi-Sweet</td><td style="text-align:right">88</td><td style="text-align:right">18</td><td style="text-align:right">nan</td><td style="text-align:right">nan</td><td style="text-align:right">nan</td><td style="text-align:left">Mike DeSimone</td><td style="text-align:left">@worldwineguys</td><td style="text-align:left">Kakhetia Traditional Winemaking 2012 Red Naturally Semi-Sweet Ojaleshi</td><td style="text-align:left">Ojaleshi</td><td style="text-align:left">Kakhetia Traditional Winemaking</td></tr><tr><td style="text-align:right">9509</td><td style="text-align:right">nan</td><td style="text-align:left">This mouthwatering blend starts with a nose of fresh mint, pineapple and mango, followed by flavors of orange peel, peach and lemon. Fresh and fruity with a mineral backbone, the wine finishes on an earthy spin. Pair with grilled sardines or poultry dishes.</td><td style="text-align:left">Theopetra Malagouzia-Assyrtiko</td><td style="text-align:right">92</td><td style="text-align:right">28</td><td style="text-align:right">nan</td><td style="text-align:right">nan</td><td style="text-align:right">nan</td><td style="text-align:left">Susan Kostrzewa</td><td style="text-align:left">@suskostrzewa</td><td style="text-align:left">Tsililis 2015 Theopetra Malagouzia-Assyrtiko White</td><td style="text-align:left">White Blend</td><td style="text-align:left">Tsililis</td></tr><tr><td style="text-align:right">9750</td><td style="text-align:right">nan</td><td style="text-align:left">This orange-style wine has a cloudy yellow-gold appearance because it spent 30 days on the skins and 100 days on the lees. It has aromas and flavors of aged apple cider and tart apple pie with an astringent finish. This style is not for everyone, but for those who appreciate orange wine made from Chardonnay, this is a solid example.</td><td style="text-align:left">Orange Nikolaevo Vineyard</td><td style="text-align:right">89</td><td style="text-align:right">28</td><td style="text-align:right">nan</td><td style="text-align:right">nan</td><td style="text-align:right">nan</td><td style="text-align:left">Jeff Jenssen</td><td style="text-align:left">@worldwineguys</td><td style="text-align:left">Ross-idi 2015 Orange Nikolaevo Vineyard Chardonnay</td><td style="text-align:left">Chardonnay</td><td style="text-align:left">Ross-idi</td></tr></tbody></table></div></details><p><code>fillna()</code> 可以</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>reviews<span class="token punctuation">.</span>region_2<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">"Unknown"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><pre><code>0         Unknown
1         Unknown
           ...   
129969    Unknown
129970    Unknown
Name: region_2, Length: 129971, dtype: object
</code></pre></div></details><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>reviews<span class="token punctuation">.</span>taster_twitter_handle<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@kerinokeefe"</span><span class="token punctuation">,</span> <span class="token string">"@kerino"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><pre><code>0            @kerino
1         @vossroger
             ...    
129969    @vossroger
129970    @vossroger
Name: taster_twitter_handle, Length: 129971, dtype: object
</code></pre></div></details><h2 id="chapter-6"><a class="anchor" href="#chapter-6">#</a> Chapter 6</h2><h3 id="renaming"><a class="anchor" href="#renaming">#</a> Renaming</h3><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>reviews<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'points'</span><span class="token punctuation">:</span> <span class="token string">'score'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><table><thead><tr><th style="text-align:right"></th><th style="text-align:left">country</th><th style="text-align:left">description</th><th style="text-align:left">designation</th><th style="text-align:right">score</th><th style="text-align:right">price</th><th style="text-align:left">province</th><th style="text-align:left">region_1</th><th style="text-align:right">region_2</th><th style="text-align:left">taster_name</th><th style="text-align:left">taster_twitter_handle</th><th style="text-align:left">title</th><th style="text-align:left">variety</th><th style="text-align:left">winery</th></tr></thead><tbody><tr><td style="text-align:right">0</td><td style="text-align:left">Italy</td><td style="text-align:left">Aromas include tropical fruit, broom, brimstone and dried herb. The palate isn't overly expressive, offering unripened apple, citrus and dried sage alongside brisk acidity.</td><td style="text-align:left">Vulkà Bianco</td><td style="text-align:right">87</td><td style="text-align:right">nan</td><td style="text-align:left">Sicily &amp; Sardinia</td><td style="text-align:left">Etna</td><td style="text-align:right">nan</td><td style="text-align:left">Kerin O’Keefe</td><td style="text-align:left">@kerinokeefe</td><td style="text-align:left">Nicosia 2013 Vulkà Bianco (Etna)</td><td style="text-align:left">White Blend</td><td style="text-align:left">Nicosia</td></tr></tbody></table></div></details><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>reviews<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'firstEntry'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">'secondEntry'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><table><thead><tr><th style="text-align:left"></th><th style="text-align:left">country</th><th style="text-align:left">description</th><th style="text-align:left">designation</th><th style="text-align:right">points</th><th style="text-align:right">price</th><th style="text-align:left">province</th><th style="text-align:left">region_1</th><th style="text-align:left">region_2</th><th style="text-align:left">taster_name</th><th style="text-align:left">taster_twitter_handle</th><th style="text-align:left">title</th><th style="text-align:left">variety</th><th style="text-align:left">winery</th></tr></thead><tbody><tr><td style="text-align:left">firstEntry</td><td style="text-align:left">Italy</td><td style="text-align:left">Aromas include tropical fruit, broom, brimstone and dried herb. The palate isn't overly expressive, offering unripened apple, citrus and dried sage alongside brisk acidity.</td><td style="text-align:left">Vulkà Bianco</td><td style="text-align:right">87</td><td style="text-align:right">nan</td><td style="text-align:left">Sicily &amp; Sardinia</td><td style="text-align:left">Etna</td><td style="text-align:left">nan</td><td style="text-align:left">Kerin O’Keefe</td><td style="text-align:left">@kerinokeefe</td><td style="text-align:left">Nicosia 2013 Vulkà Bianco (Etna)</td><td style="text-align:left">White Blend</td><td style="text-align:left">Nicosia</td></tr><tr><td style="text-align:left">secondEntry</td><td style="text-align:left">Portugal</td><td style="text-align:left">This is ripe and fruity, a wine that is smooth while still structured. Firm tannins are filled out with juicy red berry fruits and freshened with acidity. It's already drinkable, although it will certainly be better from 2016.</td><td style="text-align:left">Avidagos</td><td style="text-align:right">87</td><td style="text-align:right">15</td><td style="text-align:left">Douro</td><td style="text-align:left">nan</td><td style="text-align:left">nan</td><td style="text-align:left">Roger Voss</td><td style="text-align:left">@vossroger</td><td style="text-align:left">Quinta dos Avidagos 2011 Avidagos Red (Douro)</td><td style="text-align:left">Portuguese Red</td><td style="text-align:left">Quinta dos Avidagos</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">US</td><td style="text-align:left">Tart and snappy, the flavors of lime flesh and rind dominate. Some green pineapple pokes through, with crisp acidity underscoring the flavors. The wine was all stainless-steel fermented.</td><td style="text-align:left">nan</td><td style="text-align:right">87</td><td style="text-align:right">14</td><td style="text-align:left">Oregon</td><td style="text-align:left">Willamette Valley</td><td style="text-align:left">Willamette Valley</td><td style="text-align:left">Paul Gregutt</td><td style="text-align:left">@paulgwine</td><td style="text-align:left">Rainstorm 2013 Pinot Gris (Willamette Valley)</td><td style="text-align:left">Pinot Gris</td><td style="text-align:left">Rainstorm</td></tr></tbody></table></div></details><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>reviews<span class="token punctuation">.</span>rename_axis<span class="token punctuation">(</span><span class="token string">"fields"</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token string">'columns'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div><table><thead><tr><th style="text-align:right"></th><th style="text-align:left">country</th><th style="text-align:left">description</th><th style="text-align:left">designation</th><th style="text-align:right">points</th><th style="text-align:right">price</th><th style="text-align:left">province</th><th style="text-align:left">region_1</th><th style="text-align:left">region_2</th><th style="text-align:left">taster_name</th><th style="text-align:left">taster_twitter_handle</th><th style="text-align:left">title</th><th style="text-align:left">variety</th><th style="text-align:left">winery</th></tr></thead><tbody><tr><td style="text-align:right">0</td><td style="text-align:left">Italy</td><td style="text-align:left">Aromas include tropical fruit, broom, brimstone and dried herb. The palate isn't overly expressive, offering unripened apple, citrus and dried sage alongside brisk acidity.</td><td style="text-align:left">Vulkà Bianco</td><td style="text-align:right">87</td><td style="text-align:right">nan</td><td style="text-align:left">Sicily &amp; Sardinia</td><td style="text-align:left">Etna</td><td style="text-align:left">nan</td><td style="text-align:left">Kerin O’Keefe</td><td style="text-align:left">@kerinokeefe</td><td style="text-align:left">Nicosia 2013 Vulkà Bianco (Etna)</td><td style="text-align:left">White Blend</td><td style="text-align:left">Nicosia</td></tr><tr><td style="text-align:right">1</td><td style="text-align:left">Portugal</td><td style="text-align:left">This is ripe and fruity, a wine that is smooth while still structured. Firm tannins are filled out with juicy red berry fruits and freshened with acidity. It's already drinkable, although it will certainly be better from 2016.</td><td style="text-align:left">Avidagos</td><td style="text-align:right">87</td><td style="text-align:right">15</td><td style="text-align:left">Douro</td><td style="text-align:left">nan</td><td style="text-align:left">nan</td><td style="text-align:left">Roger Voss</td><td style="text-align:left">@vossroger</td><td style="text-align:left">Quinta dos Avidagos 2011 Avidagos Red (Douro)</td><td style="text-align:left">Portuguese Red</td><td style="text-align:left">Quinta dos Avidagos</td></tr><tr><td style="text-align:right">2</td><td style="text-align:left">US</td><td style="text-align:left">Tart and snappy, the flavors of lime flesh and rind dominate. Some green pineapple pokes through, with crisp acidity underscoring the flavors. The wine was all stainless-steel fermented.</td><td style="text-align:left">nan</td><td style="text-align:right">87</td><td style="text-align:right">14</td><td style="text-align:left">Oregon</td><td style="text-align:left">Willamette Valley</td><td style="text-align:left">Willamette Valley</td><td style="text-align:left">Paul Gregutt</td><td style="text-align:left">@paulgwine</td><td style="text-align:left">Rainstorm 2013 Pinot Gris (Willamette Valley)</td><td style="text-align:left">Pinot Gris</td><td style="text-align:left">Rainstorm</td></tr></tbody></table></div></details><h3 id="combining"><a class="anchor" href="#combining">#</a> Combining</h3><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>canadian_youtube <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"CAvideos.csv"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>british_youtube <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"GBvideos.csv"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>canadian_youtube<span class="token punctuation">,</span> british_youtube<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div></div></details><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>left <span class="token operator">=</span> canadian_youtube<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'trending_date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>right <span class="token operator">=</span> british_youtube<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'trending_date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>left<span class="token punctuation">.</span>join<span class="token punctuation">(</span>right<span class="token punctuation">,</span> lsuffix<span class="token operator">=</span><span class="token string">'_CAN'</span><span class="token punctuation">,</span> rsuffix<span class="token operator">=</span><span class="token string">'_UK'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><details class="info"><summary>運算結果</summary><div></div></details><div class="tags"><a href="/tags/python/" rel="tag"><i class="ic i-tag"></i> python</a> <a href="/tags/%E8%B3%87%E6%96%99%E5%88%86%E6%9E%90/" rel="tag"><i class="ic i-tag"></i> 資料分析</a> <a href="/tags/pandas/" rel="tag"><i class="ic i-tag"></i> pandas</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新於</span> <time title="修改時間：2022-08-25 22:51:46" itemprop="dateModified" datetime="2022-08-25T22:51:46+08:00">2022-08-25</time> </span><span id="2022/07/23/python-data-analysis-2/" class="item leancloud_visitors" data-flag-title="Pandas 資料分析 (下)" title="閱讀次數"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">閱讀次數</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div id="copyright"><ul><li class="author"><strong>作者： </strong>Zrn Ye <i class="ic i-at"><em>@</em></i>為了夢想、永不停歇</li><li class="link"><strong>文章連結：</strong> <a href="https://zrn-code.github.io/2022/07/23/python-data-analysis-2/" title="Pandas 資料分析 (下)">https://zrn-code.github.io/2022/07/23/python-data-analysis-2/</a></li><li class="license"><strong>版權聲明： </strong>本網誌所有文章除特別聲明外，均採用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 許可協議。轉載請註明出處！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/07/20/python-data-analysis-1/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicmnywqgpj20zk0m8dwx.jpg" title="Pandas 資料分析(上)"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> AI 相關</span><h3>Pandas 資料分析(上)</h3></a></div><div class="item right"></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目錄"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#chapter-4"><span class="toc-number">1.</span> <span class="toc-text">Chapter 4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#groupwise-analysis"><span class="toc-number">1.1.</span> <span class="toc-text">Groupwise analysis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multi-indexes"><span class="toc-number">1.2.</span> <span class="toc-text">Multi-indexes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sorting"><span class="toc-number">1.3.</span> <span class="toc-text">Sorting</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chapter-5"><span class="toc-number">2.</span> <span class="toc-text">Chapter 5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dtypes"><span class="toc-number">2.1.</span> <span class="toc-text">Dtypes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#missing-data"><span class="toc-number">2.2.</span> <span class="toc-text">Missing data</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chapter-6"><span class="toc-number">3.</span> <span class="toc-text">Chapter 6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#renaming"><span class="toc-number">3.1.</span> <span class="toc-text">Renaming</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#combining"><span class="toc-number">3.2.</span> <span class="toc-text">Combining</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2022/07/20/python-data-analysis-1/" rel="bookmark" title="Pandas 資料分析(上)">Pandas 資料分析(上)</a></li><li class="active"><a href="/2022/07/23/python-data-analysis-2/" rel="bookmark" title="Pandas 資料分析(下)">Pandas 資料分析(下)</a></li></ul></div><div class="overview panel" data-title="本站概要"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Zrn Ye" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Zrn Ye</p><div class="description" itemprop="description">堅強，只為那些期待眼神</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">398</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">23</span> <span class="name">分類</span></a></div><div class="item tags"><a href="/tags/"><span class="count">119</span> <span class="name">標籤</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3pybi1jb2Rl" title="https:&#x2F;&#x2F;github.com&#x2F;zrn-code"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnp4YzA5Nzg4Mjc5MDlAbWFpbC5jb20=" title="mailto:zxc0978827909@mail.com"><i class="ic i-envelope"></i></span> <span class="exturl item facebook" data-url="aHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3Byb2ZpbGUucGhwP2lkPTEwMDA1NTM3NDU4ODgzOQ==" title="https:&#x2F;&#x2F;www.facebook.com&#x2F;profile.php?id&#x3D;100055374588839"><i class="ic i-facebook"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首頁</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-user"></i>關於</a><ul class="submenu"><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>關於作者</a></li><li class="item"><a href="/about-website/" rel="section"><i class="ic i-chrome"></i>關於網站</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>歸檔</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分類</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>標籤</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-magic"></i>神奇連結</a><ul class="submenu"><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>小夥伴</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-opera"></i>推薦網站</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-star"></i>生活紀錄</a><ul class="submenu"><li class="item"><a href="/gallery" rel="section"><i class="ic i-heart"></i>圖片收藏</a></li><li class="item"><a href="/talking/" rel="section"><i class="ic i-pen"></i>輕鬆隨筆</a></li><li class="item"><a href="/bangumis/" rel="section"><i class="ic i-eye"></i>追番列表</a></li></ul></li><li class="item"><a href="/statistics/" rel="section"><i class="ic i-clock"></i>文章統計</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"></div><div class="status"><div class="copyright">&copy; 2020 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Zrn Ye @ Zrn Code</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="總字數">612k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="所需總閱讀時間">9:17</span></div><div class="powered-by">基於 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/07/23/python-data-analysis-2/",favicon:{show:"復活成功（●´3｀●）",hide:"瀏覽器崩潰啦(´Д｀)"},search:{placeholder:"文章搜尋",empty:"關於 「 ${query} 」 ，什麼也沒搜到",stats:"${time} ms 內找到 ${hits} 條結果"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js,npm/echarts@5.2.2/dist/echarts.min.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->